--- urpmi-6.68/urpm/download.pm.fix	2011-07-26 23:54:41.000000000 +0400
+++ urpmi-6.68/urpm/download.pm	2011-08-10 15:58:31.066634261 +0400
@@ -963,6 +963,8 @@ sub _sync_webfetch_raw {
 	my @l = map { urpm::file_from_local_url($_) } @$files;
 	eval { sync_file($options, @l) };
 	$urpm->{fatal}(10, $@) if $@;
+    } elsif ($proto eq 'rsync') {
+	sync_rsync($options, @$files);
     } elsif (member($proto, 'ftp', 'http', 'https') || $options->{metalink}) {
 
 	my $preferred = preferred_downloader($urpm, $medium, \$options->{metalink});
@@ -980,8 +982,6 @@ sub _sync_webfetch_raw {
 	    $sync->($options, splice(@l, 0, $n));
 	  }
 	}
-    } elsif ($proto eq 'rsync') {
-	sync_rsync($options, @$files);
     } elsif ($proto eq 'ssh') {
 	my @ssh_files = map { m!^ssh://([^/]*)(.*)! ? "$1:$2" : () } @$files;
 	sync_ssh($options, @ssh_files);
